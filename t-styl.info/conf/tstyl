<VirtualHost *:81>
    DocumentRoot /var/www/tstyl/campsite
    ServerName www.t-styl.info
    ServerAlias t-styl.info ts.omniton.net tstyl.fm www.tstyl.fm
    TransferLog /dev/null
    ExpiresActive On
    ExpiresByType text/html "access plus 10 minute"
    ExpiresByType text/xml "access plus 1 minute"
    ExpiresByType application/rss+xml "access plus 1 minute"
    ExpiresDefault "access plus 30 days"		
    DirectoryIndex index.php index.html
    <Directory /var/www/tstyl/campsite>
	Options -Indexes FollowSymLinks MultiViews
	AllowOverride All
	<IfModule mod_access.c>
	    Order allow,deny
	    Allow from all
	</IfModule>
    </Directory>	

    Redirect /phpmyadmin__ https://ts.omniton.net/phpmyadmin__
</VirtualHost>

<VirtualHost *:81>
    DocumentRoot /srv/tstyl_old/
    ServerName old.t-styl.info
    TransferLog /dev/null
    ExpiresActive On
    ExpiresByType text/html "access plus 10 minute"
    ExpiresByType text/xml "access plus 1 minute"
    ExpiresByType application/rss+xml "access plus 1 minute"
    ExpiresDefault "access plus 30 days"		
    DirectoryIndex index.php index.html
    <Directory /srv/tstyl_old/>
	Options -Indexes FollowSymLinks MultiViews
	AllowOverride All
	<IfModule mod_access.c>
	    Order allow,deny
	    Allow from all
	</IfModule>
    </Directory>	

    Redirect /admin https://ts.omniton.net/admin
    Redirect /banner http://openx.omniton.net
    Redirect /phpmyadmin__ https://ts.omniton.net/phpmyadmin__
</VirtualHost>

<VirtualHost *:443>
#ErrorLog logs/ssl_error_log
#TransferLog logs/ssl_access_log
LogLevel warn
SSLEngine on
SSLProtocol all -SSLv2
SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:RC4+RSA:+HIGH:+MEDIUM:+LOW
SSLCertificateFile /etc/ssl/www/omniton.net/cert.pem
SSLCertificateKeyFile /etc/ssl/www/omniton.net/key.pem
SSLCACertificateFile /etc/ssl/ca/cacert.pem
SSLCARevocationFile /etc/ssl/ca/ca.crl
SSLVerifyDepth 2
SSLOptions +FakeBasicAuth +ExportCertData
SSLVerifyClient require
				    
#CustomLog logs/ssl_request_log "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"

    DocumentRoot /var/www/tstyl/campsite
    ServerName ts.omniton.net
    ServerAlias tsr.omniton.net www.t-styl.info www.tstyl.fm
    DirectoryIndex index.php index.html
    <Directory /var/www/tstyl/campsite>
	Options -Indexes FollowSymLinks MultiViews
	AllowOverride All
        SSLRequire %{SSL_CLIENT_S_DN_OU} eq "Admin" or %{SSL_CLIENT_S_DN_OU} eq "tstyl"
	<IfModule mod_access.c>
	    Order allow,deny
	    Allow from all
	</IfModule>
    </Directory>	
</VirtualHost>                                  


